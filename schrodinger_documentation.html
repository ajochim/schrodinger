
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Schrodinger &#8212; schrodinger 1.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="toctree-wrapper compound">
</div>
<div class="section" id="schrodinger">
<h1>Schrodinger<a class="headerlink" href="#schrodinger" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>A program that solves the 1d schrodinger equation. It reads
a file <em>schrodinger.inp</em> that specifies a given potential and calculates
energies, wavefunctions, expectation values and standard deviation. All data
is plotted afterwards and saved to <em>schrodinger.pdf.</em></p>
</div>
<div class="section" id="input-and-output">
<h2>Input and Output<a class="headerlink" href="#input-and-output" title="Permalink to this headline">¶</a></h2>
<p>The name of the input file must be called <strong>schrodinger.inp</strong>. By default
<em>schrodinger</em> assumes it is located in the same directory as itself.
Other directory can be accessed via the <em>-d</em> starting option. The input file
must have the following structure:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">4.0</span>           <span class="c1"># Mass</span>
<span class="o">-</span><span class="mf">5.0</span> <span class="mf">5.0</span> <span class="mi">1999</span> <span class="c1"># xMin xMax nPoint</span>
<span class="mi">1</span> <span class="mi">5</span>           <span class="c1"># first and last eigenvalue to include in the output</span>
<span class="n">polynomial</span>    <span class="c1"># interpolation type</span>
<span class="mi">3</span>             <span class="c1"># # nr. of interpolation points and xy declarations</span>
<span class="o">-</span><span class="mf">1.0</span> <span class="mf">0.5</span>
<span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="mf">1.0</span> <span class="mf">0.5</span>
</pre></div>
</div>
<p>You can use as many interpolation points as you want. The number has to fit
the number of xy declarations afterwards. Possible interpolation types are
<em>linear</em>, <em>csplines</em> and <em>polynomial</em>. <em>nPoints</em> is the number of discrete
points that are used for calculating.</p>
<p>All calculations are saved in the following files. They are used to plot
the data and can be used for further work:</p>
<ul>
<li><p class="first"><em>potential.dat</em></p>
<p>interpolated potential in XY-Format:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="n">V</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="n">x2</span> <span class="n">V</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="p">:</span>    <span class="p">:</span>
</pre></div>
</div>
</li>
<li><p class="first"><em>energies.dat</em></p>
<p>calculated eigenvalues</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">E1</span>
<span class="n">E2</span>
<span class="n">E3</span>
<span class="p">:</span>
</pre></div>
</div>
</li>
<li><p class="first"><em>wavefuncs.dat</em></p>
<p>calculated wavefunctions in NXY-Format</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="n">wf1</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="n">wf2</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="n">wf3</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="o">...</span>
<span class="n">x2</span> <span class="n">wf1</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span> <span class="n">wf2</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span> <span class="n">wf3</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span> <span class="o">...</span>
<span class="p">:</span>
</pre></div>
</div>
</li>
<li><p class="first"><em>expvalues.dat</em></p>
<p>expectation values and standard deviation</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">exp_val1</span> <span class="n">st_dev1</span>
<span class="n">exp_val2</span> <span class="n">st_dev2</span>
<span class="p">:</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="starting-options">
<h2>Starting Options<a class="headerlink" href="#starting-options" title="Permalink to this headline">¶</a></h2>
<p>Starting options (optional parameters) for the main module <em>schrodinger.py</em>.
Use the long form as -<em>-name</em> or use the short version showed below.</p>
<div class="section" id="optional-parameters">
<h3>Optional Parameters<a class="headerlink" href="#optional-parameters" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">directory: -d [path]</p>
<p>Used to specify the path of the input file <em>schrodinger.inp</em></p>
</li>
<li><p class="first">split: -s</p>
<p>Splitting the wavefunctions, expectation values and standard deviations in
the plot for a better view.</p>
</li>
<li><p class="first">stretch: -st [float]</p>
<p>Multiplies the wavefunctions with a factor for a better view.</p>
</li>
<li><p class="first">markersize: -m [float]</p>
<p>Changes the markersize of the expectation values and standard deviation.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="modules">
<h2>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h2>
<div class="section" id="schrodinger-py">
<h3>schrodinger.py<a class="headerlink" href="#schrodinger-py" title="Permalink to this headline">¶</a></h3>
<p>Main module that can be used with the starting options (optional parameters)
above.</p>
</div>
<div class="section" id="module-schrodinger_io">
<span id="schrodinger-io-py"></span><h3>schrodinger_io.py<a class="headerlink" href="#module-schrodinger_io" title="Permalink to this headline">¶</a></h3>
<p>Module that reads the input data, processed by the schrodinger solver</p>
<dl class="function">
<dt id="schrodinger_io.output">
<code class="descclassname">schrodinger_io.</code><code class="descname">output</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#schrodinger_io.output" title="Permalink to this definition">¶</a></dt>
<dd><p>Write calculated data to files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<em>dict</em>) – dictionary with calculated data from solve1d</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="schrodinger_io.read_input">
<code class="descclassname">schrodinger_io.</code><code class="descname">read_input</code><span class="sig-paren">(</span><em>file</em><span class="sig-paren">)</span><a class="headerlink" href="#schrodinger_io.read_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Read given parameters and potential data of ‘schrodinger.inp’</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong> (<em>str</em>) – path to input file schrodinger.inp</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">obtained input from ‘file’</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">obtained_input (dict)</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">OSError</span></code> – if input file is not present or has wrong permissions/name</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-schrodinger_solver">
<span id="schrodinger-solver-py"></span><h3>schrodinger_solver.py<a class="headerlink" href="#module-schrodinger_solver" title="Permalink to this headline">¶</a></h3>
<p>Module that solves the onedimensional Schrodinger equation for arbitrary potentials</p>
<dl class="function">
<dt id="schrodinger_solver.interpolate">
<code class="descclassname">schrodinger_solver.</code><code class="descname">interpolate</code><span class="sig-paren">(</span><em>obtained_input</em><span class="sig-paren">)</span><a class="headerlink" href="#schrodinger_solver.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolation routine, that interpolates the given potential data with
a specified interpolation method</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>obtained_input</strong> (<em>dict</em>) – obtained input of schrodinger_io.read_input()</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">contains interpolated potential</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">interppot (numpy array)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="schrodinger_solver.solve1d">
<code class="descclassname">schrodinger_solver.</code><code class="descname">solve1d</code><span class="sig-paren">(</span><em>obtained_input</em>, <em>pot</em><span class="sig-paren">)</span><a class="headerlink" href="#schrodinger_solver.solve1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves the discretized 1D schrodinger equation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>obtained_input</strong> (<em>dict</em>) – obtained input of schrodinger_io.read_input()</li>
<li><strong>pot</strong> (<em>numpy array</em>) – contains potential</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">calculated data; potential, energies, wavefuncs, expvalues</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">data (dict)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-schrodinger_visualize">
<span id="schrodinger-visualize-py"></span><h3>schrodinger_visualize.py<a class="headerlink" href="#module-schrodinger_visualize" title="Permalink to this headline">¶</a></h3>
<p>Visualization module for the schrodinger_solver</p>
<dl class="function">
<dt id="schrodinger_visualize.show">
<code class="descclassname">schrodinger_visualize.</code><code class="descname">show</code><span class="sig-paren">(</span><em>stretchfactor=1</em>, <em>split=False</em>, <em>markersize=10</em><span class="sig-paren">)</span><a class="headerlink" href="#schrodinger_visualize.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualizes the output of the solver function and saves to schrodinger.pdf</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>stretchfactor</strong> (<em>float</em>) – stretches the wavefunctions in y-direction</li>
<li><strong>split</strong> (<em>bool</em>) – creates offset to wavefunction, expectationsvalues</li>
<li><strong>standard deviation if set to 'True'</strong> (<em>and</em>) – </li>
<li><strong>markersize</strong> (<em>float</em>) – changes markersize of expectations values and standard deviation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal"><span class="pre">OSError</span></code> – if input file is not present or has wrong permissions/name</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-test_schrodinger_solver">
<span id="test-schrodinger-solver-py"></span><h3>test_schrodinger_solver.py<a class="headerlink" href="#module-test_schrodinger_solver" title="Permalink to this headline">¶</a></h3>
<p>Contains routines to test the solvers modules</p>
<dl class="function">
<dt id="test_schrodinger_solver.test_compare">
<code class="descclassname">test_schrodinger_solver.</code><code class="descname">test_compare</code><span class="sig-paren">(</span><em>testname_compare</em><span class="sig-paren">)</span><a class="headerlink" href="#test_schrodinger_solver.test_compare" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests the constant functioning of the code by comparing previously
calculated energy-levels and potential data with the current output of the solver</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>testname_compare</strong> (<em>str</em>) – to create path of reference and input files</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Asserting:</dt>
<dd>test_compare_assert (bool): if ‘True’, test passes</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="test_schrodinger_solver.test_energies">
<code class="descclassname">test_schrodinger_solver.</code><code class="descname">test_energies</code><span class="sig-paren">(</span><em>testname_energie</em><span class="sig-paren">)</span><a class="headerlink" href="#test_schrodinger_solver.test_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests the energy-levels of schrodinger_solver by comparing thoose
with exact results or groundstates calculated on paper</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>testname_energie</strong> (<em>str</em>) – to create path of reference and input files</li>
<li><strong>energie data/parameters</strong> (<em>containing</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Asserting:</dt>
<dd>test_energies_assert (bool): if ‘True’, test passes</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="test_schrodinger_solver.test_interpolation">
<code class="descclassname">test_schrodinger_solver.</code><code class="descname">test_interpolation</code><span class="sig-paren">(</span><em>testname_interp</em><span class="sig-paren">)</span><a class="headerlink" href="#test_schrodinger_solver.test_interpolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Tests the interpolation of schrodinger_solver by comparing the
interpolated potential with the given XY data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>testname_interp</strong> (<em>str</em>) – to create path of reference and input files</li>
<li><strong>potential data/parameters</strong> (<em>containing</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Asserting:</dt>
<dd>test_interp (bool): if ‘True’, test passes</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="scientific-notes">
<h2>Scientific Notes<a class="headerlink" href="#scientific-notes" title="Permalink to this headline">¶</a></h2>
<p>All calculations are numeric! The potential defined by discrete reference
points inside the input file is interpolated using numerical algorithms
(e.g., finite differences and integrals as Riemann sums).
The constructions of a tridiagonal matrix allows solving the time independent
schrodinger equation at discrete points as an eigenvalue problem. This
results in inaccuracies both due to discretization errors and due to rounding
errors in the floating-point number calculation.</p>
<p>The probability of the particle to be inside the given x-boundaries is treated
as 100%, so the probablity outside has to be 0. Therefore the problem has
aquivalent additonal infinite high potential walls at ‘xmin’ and ‘xmax’.
In case of non-decreasing wavefunction amplitudes outside the potential
boundaries, reconsideration of the calculated solutions is recommended.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Schrodinger</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#input-and-output">Input and Output</a></li>
<li><a class="reference internal" href="#starting-options">Starting Options</a><ul>
<li><a class="reference internal" href="#optional-parameters">Optional Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#modules">Modules</a><ul>
<li><a class="reference internal" href="#schrodinger-py">schrodinger.py</a></li>
<li><a class="reference internal" href="#module-schrodinger_io">schrodinger_io.py</a></li>
<li><a class="reference internal" href="#module-schrodinger_solver">schrodinger_solver.py</a></li>
<li><a class="reference internal" href="#module-schrodinger_visualize">schrodinger_visualize.py</a></li>
<li><a class="reference internal" href="#module-test_schrodinger_solver">test_schrodinger_solver.py</a></li>
</ul>
</li>
<li><a class="reference internal" href="#scientific-notes">Scientific Notes</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Tammo van der Heide and Alexander Jochim.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>